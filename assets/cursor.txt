The primary key of each relation is underlined. The value 1 for attribute GENDER in APPLICANT relation indicates ‘Male’ and the value 2 for attribute GENDER in APPLICANT relation means ‘Female’. The value 1 for attribute SPLRES (special reservation) if APPLICANT relation indicates ‘Applicable' and the value 2 for attribute SPLRES in APPLICANT relation means ‘Not Applicable’.
Examination and Interview are conducted by two different agencies. The attribute RND of RANDOM relation should be Unique.
Perform the following using any two relational database management system.
-> Populate the APPLICANT relation with 20 tuples. 12 tuples with no special reservation and 8 tuples with special reservation.
-> Write a function to populate the value of REST in RANDOM  relation
-> Write a function to populate the value of TEST attribute in APPLICANT relation from the TEST relation.
-> Write a procedure to populate the values for INTERVIEW attribute in APPLICANT relation from the INTERVIEW relation.
-> Write a procedure to populate the values of RND attribute in APPLICANT  relation from the RANDOM relation
-> Update the value of AGGR in APPLICANT relation (AGGR - 50% of Test Marks + 50 % of Interview Marks)
-> Write the procedure to generate rank
-> Write a procedure to generate special reservation rank

Note :
Special reservation rank should be generated for Applicants from whom special reservation is applicable
Tie Break AGGR first ,TEST second ,INTERVIEW third , DATE OF BIRTH fourth and finally RANDOM NUMBER.


************************************ANSWER***********************************

CREATE TABLE APPLICANT(
APPNO NUMBER(6) PRIMARY KEY,
NAME VARCHAR(30) ,
DOB DATE,
GENDER NUMBER(1) CHECK(GENDER IN (1,2)),
SPLRES NUMBER(1) CHECK (SPLRES IN (1,2)),
TEST NUMBER(3) ,
INTERVIEW NUMBER(3),
AGGR NUMBER(6,3),
RND NUMBER(10),
RANK NUMBER(5),
SPLRANK NUMBER(5));

CREATE TABLE TEST(
APPNO NUMBER(6) PRIMARY KEY,
NAME VARCHAR(30),
TEST NUMBER(3),
FOREIGN KEY(APPNO) REFERENCES APPLICANT(APPNO));

CREATE TABLE INTERVIEW(
APPNO NUMBER(6) PRIMARY KEY,
NAME VARCHAR(30),
INTERVIEW NUMBER(3),
FOREIGN KEY (APPNO)  REFERENCES APPLICANT(APPNO)
);

CREATE TABLE RANDOM(
APPNO NUMBER(6) PRIMARY KEY,
NAME VARCHAR(30),
RND NUMBER(10),
FOREIGN KEY (APPNO) REFERENCES APPLICANT(APPNO));

INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200001,’PETER’,’02-APR-2001’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200002,’JOHN’,’02-MAR-2001’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200003,’RAM’,’02-APR-2002’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200004,’ANITHA’,’02-MAR-2015’,2,2);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200005,’ROBERT’,’02-MAR-2010’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200006,’EMY’,’02-MAR-2011’,2,2);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200007,’LINI’,’02-MAR-2009’,2,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200008,’MANJU’,’02-MAR-2008’,2,2);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200009,’PRITHI’,’02-MAR-2019’,2,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200010,’ABRAHAM’,’02-MAR-2019’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200011,’DONALD’,’02-MAR-2019’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200012,’HAMEN’,’02-MAR-2005’,1,2);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200013,’TOM’,’02-MAR-2006’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200014,’BOB’,’02-MAR-2003’,1,2);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200015,’MINI’,’02-MAR-2004’,1,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200016,’PRIYA’,’02-MAR-2002’,2,2);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200017,’LARA’,’02-MAR-2000’,2,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200018,’ZARA’,’02-MAR-2018’,2,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200019,’THARA’,’02-MAR-2017’,2,1);
INSERT INTO APPLICANT (APPNO,NAME,DOB,GENDER,SPLRES) VALUES(200020,’VINOD’,’02-MAR-2014’,1,1);

COMMIT
SET LINES 200
SELECT * FROM APPLICANT;
SET PAGES 50

SELECT * FROM APPLICANT;
INSERT INTO TEST(APPNO, NAME) SELECT APPNO,NAME FROM APPLICANT;
INSERT INTO INTERVIEW(APPNO,NAME,INTERVIEW) SELECT APPNO,NAME FROM APPLICANT;
INSERT INTO RANDOM(APPNO,NAME) SELECT APPNO,NAME FORM APPLICANT;
SELECT * FROM TEST;
SELECT * FROM INTERVIEW;


UPDATE TEST SET TEST = 98 WHERE APPNO = 200001;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200002;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200003;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200004;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200005;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200006;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200007;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200008;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200009;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200010;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200011;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200012;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200013;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200014;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200015;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200016;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200017;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200018;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200019;
UPDATE TEST SET TEST = 98 WHERE APPNO = 200020;



--- TO UPDATE THE TEST MARK FROM TEST TABLE TO APPLICANT TABLE

DECLARE
    CURSOR C IS SELECT APPNO, TEST FROM TEST;
BEGIN
    FOR I IN C LOOP
        UPDATE APPLICANT 
        SET TEST = I.TEST 
        WHERE APPNO = I.APPNO;
    END LOOP;
    COMMIT; -- Ensure changes are saved
END;
/



--20 RECORDS UPDATING IN INTERVIEW TABLE:

UPDATE INTERVIEW SET INTERVIEW = 50 WHERE APPNO = 200001;
UPDATE INTERVIEW SET INTERVIEW = 65 WHERE APPNO = 200002;
UPDATE INTERVIEW SET INTERVIEW = 70 WHERE APPNO = 200003;
UPDATE INTERVIEW SET INTERVIEW = 70 WHERE APPNO = 200004;
UPDATE INTERVIEW SET INTERVIEW = 70 WHERE APPNO = 200005;
UPDATE INTERVIEW SET INTERVIEW = 70 WHERE APPNO = 200006;
UPDATE INTERVIEW SET INTERVIEW = 55 WHERE APPNO = 200007;
UPDATE INTERVIEW SET INTERVIEW = 50 WHERE APPNO = 200008;
UPDATE INTERVIEW SET INTERVIEW = 45 WHERE APPNO = 200009;
UPDATE INTERVIEW SET INTERVIEW = 55 WHERE APPNO = 200010;
UPDATE INTERVIEW SET INTERVIEW = 45 WHERE APPNO = 200011;
UPDATE INTERVIEW SET INTERVIEW = 70 WHERE APPNO = 200012;
UPDATE INTERVIEW SET INTERVIEW = 65 WHERE APPNO = 200013;
UPDATE INTERVIEW SET INTERVIEW = 60 WHERE APPNO = 200014;
UPDATE INTERVIEW SET INTERVIEW = 55 WHERE APPNO = 200015;
UPDATE INTERVIEW SET INTERVIEW = 50 WHERE APPNO = 200016;
UPDATE INTERVIEW SET INTERVIEW = 65 WHERE APPNO = 200017;
UPDATE INTERVIEW SET INTERVIEW = 60 WHERE APPNO = 200018;
UPDATE INTERVIEW SET INTERVIEW = 55 WHERE APPNO = 200019;
UPDATE INTERVIEW SET INTERVIEW = 50 WHERE APPNO = 200020;


--- TO UPDATE THE INTERVIEW MARK FROM INTERVIEW TABLE TO APPLICANT TABLE

DECLARE
  2     CURSOR C IS SELECT APPNO, INTERVIEW FROM INTERVIEW;
  3  BEGIN
  4     FOR I IN C LOOP
  5             UPDATE APPLICANT
  6             SET INTERVIEW = I.INTERVIEW
  7             WHERE APPNO = I.APPNO;
  8     END LOOP;
  9     COMMIT;
 10  END;
 11  /


UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200001;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200002;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200003;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200004;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200005;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200006;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200007;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200008;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200009;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200010;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200011;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200012;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200013;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200014;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200015;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200016;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200017;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200018;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200019;
UPDATE RANDOM SET RND = TRUNC(DBMS_RANDOM.VALUE(1000000000, 9999999999)) WHERE APPNO = 200020;

--TO UPDATE RND IN APPLICANT TABLE FROM RANDOM TABLE:

DECLARE
    CURSOR C IS SELECT APPNO, RND FROM RANDOM;
BEGIN
    FOR I IN C LOOP
        UPDATE APPLICANT
        SET RND = I.RND
        WHERE APPNO = I.APPNO;
    END LOOP;  -- Corrected here
    COMMIT;
END;
/

--PROCEDURE FOR GENERATING RANK

CREATE OR REPLACE PROCEDURE GENERATE_RANKS_CURSOR IS
    CURSOR C_RANK IS
        SELECT APPNO
        FROM APPLICANT
        ORDER BY AGGR DESC, TEST DESC, INTERVIEW DESC, DOB ASC, RND ASC;

    V_RANK NUMBER := 0;
BEGIN
    FOR REC IN C_RANK LOOP
        V_RANK := V_RANK + 1;

        UPDATE APPLICANT
        SET RANK = V_RANK
        WHERE APPNO = REC.APPNO;
    END LOOP;

    COMMIT;
END;
/

--FOR EXECUTING THE PROCEDURE:
BEGIN
    GENERATE_RANKS_CURSOR;
END;
/



--PROCEDURE FOR GENERATING SPLRANK:


CREATE OR REPLACE PROCEDURE GENERATE_SPLRANKS_CURSOR IS
    CURSOR C_SPLRANK IS
        SELECT APPNO
        FROM APPLICANT
        WHERE SPLRES = 2
        ORDER BY AGGR DESC, TEST DESC, INTERVIEW DESC, DOB ASC, RND ASC;

    V_SPLRANK NUMBER := 0;
BEGIN
    FOR REC IN C_SPLRANK LOOP
        V_SPLRANK := V_SPLRANK + 1;

        UPDATE APPLICANT
        SET SPLRANK = V_SPLRANK
        WHERE APPNO = REC.APPNO;
    END LOOP;

    COMMIT;
END;
/


--FOR EXECUTING SPLRANK:


BEGIN
    GENERATE_SPLRANKS_CURSOR;
END;
/









